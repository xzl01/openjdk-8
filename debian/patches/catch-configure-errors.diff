Description: actually do catch errors from configure
Author: mirabilos <tg@debian.org>
Forwarded: https://mail.openjdk.org/pipermail/jdk8u-dev/2024-January/017918.html

--- a/common/autoconf/configure
+++ b/common/autoconf/configure
@@ -253,9 +253,10 @@ fi
 # Now transfer control to the script generated by autoconf. This is where the
 # main work is done.
 conf_logfile=./configure.log
-(exec 3>&1 ; (. $conf_script_to_run "${conf_processed_arguments[@]}" 2>&1 1>&3 ) | tee -a $conf_logfile 1>&2 ; exec 3>&-) | tee -a $conf_logfile
+conf_result_code_file=./configure.errorlevel
+(exec 3>&1 ; (set +e; (. $conf_script_to_run "${conf_processed_arguments[@]}" 2>&1 1>&3 ); echo $? >$conf_result_code_file) | tee -a $conf_logfile 1>&2 ; exec 3>&-) | tee -a $conf_logfile
 
-conf_result_code=$?
+conf_result_code=$(cat $conf_result_code_file || echo 255)
 ###
 ### Post-processing
 ###
